---
title: '中间件小计'
date: 2021-09-28 23:07:15
# 永久链接
permalink: '/go/gin/m1'
sidebar: 'auto'
isShowComment: true
categories:
 - note
tags:
 - go
 - gin
 - middleware
---



## gin的中间件使用

>   中间件定义

```go
func m1(c *gin.Context) {
	fmt.Printf("m1 in ...")
	start := time.Now()
	c.Next() // 调用后面的
	cost := time.Since(start)
	fmt.Printf("cost: %v\n", cost)
	fmt.Println("m1 out...")
	//c.Abort() // 组织调后续的处理
}
```

>   中间件注册

```go
// 全局注册中间件函数 m1
r.Use(m1)
```



```go
// 只在某个路由里使用
// 使用中间件
r.GET("/middleware", m1, func(c *gin.Context) {
  c.JSON(http.StatusOK, gin.H{
    "msg": "middleware",
  })
})
```



如果有多个中间件的执行顺序

![image-20210928230949186](/vue-blog/assets/images/image-20210928230949186.png)

