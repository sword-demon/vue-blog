(window.webpackJsonp=window.webpackJsonp||[]).push([[181],{739:function(s,n,a){"use strict";a.r(n);var e=a(4),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"},[s._v("转自")]),a("p",[a("a",{attrs:{href:"https://www.skyue.com/19101819.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.skyue.com/19101819.html"),a("OutboundLink")],1)])]),a("h2",{attrs:{id:"一、普通记账-vs-复式记账"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、普通记账-vs-复式记账"}},[s._v("#")]),s._v(" 一、普通记账 vs 复式记账")]),s._v(" "),a("p",[s._v("Beancount 记账方法叫复式记账。")]),s._v(" "),a("p",[s._v("把只记录收支的方法称为"),a("strong",[s._v("普通记账")]),s._v("（估计是多数人在用的方法）。那么"),a("strong",[s._v("复式记账")]),s._v("，除了记录收支，还需记录账户（支付宝、银行卡等）的变动。以一个最简单的例子感受二者的区别：")]),s._v(" "),a("p",[s._v("假设：7 月 1 日，打车花费 30 元，使用"),a("strong",[s._v("银行卡")]),s._v("支付。")]),s._v(" "),a("p",[s._v("普通记账一般包括日期、收支分类和金额，如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("2019-08-28: 交通-打车 -200元\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("复式记账把账户变化也一并记账，如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("2019-08-28:\n    交通-打车    200元\n    银行卡      -200元\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("复式记账会记录每笔交易的资金流动，各账户变化「有正有负，正负相等」。这便是复式记账的基本原理，称之为「会计恒等式」")]),s._v("。这种方式能够保证记账准确无误，也能提供更详细的财务分析。")]),s._v(" "),a("p",[s._v("这句话中的"),a("strong",[s._v("账户")]),s._v("是广义的，也可理解为分类，「银行卡」和「交通 - 打车」都是账户。下文中出现账户，若无特别说明，均指广义的账户。")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"二、beancount-入门"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、beancount-入门"}},[s._v("#")]),s._v(" 二、Beancount 入门")]),s._v(" "),a("p",[a("strong",[s._v("复式记账是方法论，而 Beancount 则是支持复式记账的工具")]),s._v("，Beancount 有以下三个优点：")]),s._v(" "),a("ol",[a("li",[s._v("完整个人财务数据比较敏感，Beancount 本地存储，不用担心数据泄露。")]),s._v(" "),a("li",[s._v("纯文本账本，不依赖特定软件，便于数据迁移。")]),s._v(" "),a("li",[s._v("Beancount 是开源软件。")])]),s._v(" "),a("p",[s._v("接下来介绍 Beancount 的基础使用。")]),s._v(" "),a("h3",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("p",[s._v("beancount 是个 Python 项目，安装好 "),a("a",{attrs:{href:"https://www.python.org/downloads/",target:"_blank",rel:"noopener noreferrer"}},[s._v("python"),a("OutboundLink")],1),s._v(" 后，执行：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pip install beancount\npip install fava\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("Fava 是关联软件，为 Beancount 提供一个更漂亮的 Web 界面（如图 1/2/3），建议同时安装。")]),s._v(" "),a("h3",{attrs:{id:"账本示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#账本示例"}},[s._v("#")]),s._v(" 账本示例")]),s._v(" "),a("p",[s._v("Beancount 的使用非常简单，概括为两步：")]),s._v(" "),a("p",[a("strong",[s._v("第一步")]),s._v("：使用文本文件按一定格式记账。")]),s._v(" "),a("p",[s._v("下面是个完整示例，直接保存为 "),a("code",[s._v("moneybook.bean")]),s._v("（Beancount 的文件扩展名为"),a("code",[s._v(".bean")]),s._v("）")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(';【一、账本信息】\noption "title" "我的账本" ;账本名称\noption "operating_currency" "CNY" ;账本主货币\n\n;【二、账户设置】\n;1、开设账户\n1990-01-01 open Assets:Card:1234 CNY, USD ;尾号1234的银行卡，支持CNY和USD\n1990-01-01 open Liabilities:CreditCard:5678 CNY, USD ;双币信用卡\n1990-01-01 open Income:Salary CNY ;工资收入\n1990-01-01 open Expenses:Tax CNY ;交税\n1990-01-01 open Expenses:Traffic:Taxi CNY ;打车消费，只支持CNY\n1990-01-01 open Equity:OpenBalance ;用于账户初始化，支持任意货币\n\n;2、账户初始化\n2019-08-27 * "" "银行卡，初始余额10000元"\n    Assets:Card:1234           10000.00 CNY\n    Equity:OpenBalance        -10000.00 CNY\n\n;【三、交易记录】\n2019-08-28 * "杭州出租车公司" "打车到公司，银行卡支付"\n    Expenses:Traffic:Taxi        200.00 CNY\n    Assets:Card:1234            -200.00 CNY\n\n2019-08-29 * "" "餐饮"\n    Assets:Card:1234           -1100.00 CNY\n    Liabilities:CreditCard:5678 1100.00 CNY\n    \n2019-08-31 * "XX公司" "工资收入"\n    Assets:Card:1234           12000.00 CNY\n    Expenses:Tax                1000.00 CNY\n    Income:Salary             \n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("p",[a("strong",[s._v("第二步")]),s._v("：命令行执行 "),a("code",[s._v("fava moneybook.bean")]),s._v("，看到如下结果：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" $ fava moneybook.bean                                                                                                                                              \nRunning Fava on http://localhost:5000\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("再到浏览器中打开 "),a("code",[s._v("http://localhost:5000")]),s._v(" 就能看到账本，下图分别是损益表、资产负债表、日记账的截图。其它栏目自行探索。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://static.skyue.com/blog_static/2019/191018-moneybook-1.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://static.skyue.com/blog_static/2019/191018-moneybook-1.png",alt:"记账神器Beancount教程"}}),a("OutboundLink")],1),s._v("图 1 - 损益表")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://static.skyue.com/blog_static/2019/191018-moneybook-2.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://static.skyue.com/blog_static/2019/191018-moneybook-2.png",alt:"记账神器Beancount教程"}}),a("OutboundLink")],1),s._v("图 2 - 资产负债表")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://static.skyue.com/blog_static/2019/191018-moneybook-3.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://static.skyue.com/blog_static/2019/191018-moneybook-3.png",alt:"记账神器Beancount教程"}}),a("OutboundLink")],1),s._v("图 3 - 日记账")]),s._v(" "),a("h3",{attrs:{id:"记账格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#记账格式"}},[s._v("#")]),s._v(" 记账格式")]),s._v(" "),a("p",[s._v("使用 Beancount，关键就是了解它的记账格式。从示例可知，账本包括三个部分：")]),s._v(" "),a("ul",[a("li",[s._v("账本信息：比如账本名称，账本主货币。")]),s._v(" "),a("li",[s._v("账户设置：包括开设账户和账户初始化。")]),s._v(" "),a("li",[s._v("交易记录：日常记账。")])]),s._v(" "),a("p",[s._v("下面依次介绍。")]),s._v(" "),a("h4",{attrs:{id:"账本信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#账本信息"}},[s._v("#")]),s._v(" 账本信息")]),s._v(" "),a("p",[s._v("一般设置账本的名称和主货币即可。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('option "title" "我的账本" ;账本名称\noption "operating_currency" "CNY" ;账本主货币\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"账户设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#账户设置"}},[s._v("#")]),s._v(" 账户设置")]),s._v(" "),a("p",[s._v("【开户】")]),s._v(" "),a("p",[s._v("记账之前，得有账户，开户格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("开启日期 open 账户名 货币类型\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Beancount 中账户名支持层级，以英文冒号"),a("code",[s._v(":")]),s._v(" 分隔，如 "),a("code",[s._v("Assets:Card:1234")]),s._v("。但第一层必须是以下五个账户之一，日常交易中涉及到的账户，一定可以归于其中某一类：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("收入（Income）")]),s._v("：工资、投资收益等。")]),s._v(" "),a("li",[a("strong",[s._v("支出（Expenses）")]),s._v("：衣、食、住、行等。")]),s._v(" "),a("li",[a("strong",[s._v("资产（Assets）")]),s._v("：储蓄卡余额、支付宝余额、股票账户余额、房子、车子等。")]),s._v(" "),a("li",[a("strong",[s._v("负债（Liabilities）")]),s._v("：信用卡欠款、房贷、车贷等。")]),s._v(" "),a("li",[a("strong",[s._v("权益（Equity）")]),s._v("：这个账户比较特殊，在账户初始化、误差处理等少数场合使用。")])]),s._v(" "),a("p",[s._v("开启日期可使用真实日期，若忘了了，我习惯使用自己的生日或开始复式记账的前一天（2019-06-30）。")]),s._v(" "),a("p",[s._v("开设账户时货币类型不是必须的，但建议加上，记录交易时货币不一致 Beancount 会报错。货币可设多个，用英文逗号（,）分隔。")]),s._v(" "),a("p",[s._v("最后，如果一个账户不再使用，比如注销信用卡。可用 "),a("code",[s._v("close")]),s._v(" 命令关闭账户。如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("关闭日期 close 账户名\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("【初始化】")]),s._v(" "),a("p",[s._v("当我们开始记账时，一般资产和负债都不会是 0，因此需要对资产和负债账户进行初始化。初始化的格式与交易明细完全一致，请参考正文的交易明细介绍。")]),s._v(" "),a("p",[s._v("唯一不同，初始化需要用到 Equity 账户。如示例中的 "),a("code",[s._v("Assets:Card:1234")]),s._v("，初始金额 10000 元来自 "),a("code",[s._v("Equity:OpenBalance")]),s._v("。")]),s._v(" "),a("h4",{attrs:{id:"交易明细"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#交易明细"}},[s._v("#")]),s._v(" 交易明细")]),s._v(" "),a("p",[s._v("账户设置中的初始化，和交易明细有关，因此先介绍交易明细的记录格式。如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('日期 * "交易方" "交易备注"\n    账户   金额 货币\n    账户   金额 货币\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("其中")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("*")]),s._v(" 号表示这笔交易是确定的，没有疑问。若是 "),a("code",[s._v("!")]),s._v(" 号，表示存疑，但一般用不上。")]),s._v(" "),a("li",[s._v("交易方和交易备注，均可省略。")]),s._v(" "),a("li",[s._v("货币必须与账户设置中对应的货币类型一致。比如账户设置为美元账户，消费时出现人民币，Beancount 会报错。")])]),s._v(" "),a("p",[s._v("此外，账户后的金额是带有符号的，如下：")]),s._v(" "),a("ul",[a("li",[s._v("支出账户：一般为正数。表示花费多少钱。")]),s._v(" "),a("li",[s._v("收入账户：一般为负数。表示收入多少钱。投资收入账户可能出现正数，则表示投资亏损。")]),s._v(" "),a("li",[s._v("资产账户：可正可负。正数表示有钱存入，余额增加；负数表示有钱转出，余额减少。")]),s._v(" "),a("li",[s._v("负债账户：可正可负。正数表示还款，负债减少；负数表示借款，负债增加。")])]),s._v(" "),a("p",[s._v("**支出为正，收入为负，**有点反直觉，是会计恒等式逻辑所致。会计恒等式具体表述如下：")]),s._v(" "),a("blockquote",[a("p",[s._v("(Assets + Expenses) + (Liabilities + Income) + Equity = 0")])]),s._v(" "),a("p",[s._v("一笔交易记录可能涉及 2 个以上的账户，比如例子中的「工资收入」，这时，多个账户的金额也满足「"),a("strong",[s._v("有正有负，正负相等")]),s._v("」。实际记录时，Beancount 允许一个账户的金额为空，它会根据正负相等的原则自动计算。")]),s._v(" "),a("p",[s._v("看到这里，已经可以开始动手记账了。开设好账户，然后初始化，最后每天记录交易。")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"三、beancount-实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、beancount-实践"}},[s._v("#")]),s._v(" 三、Beancount 实践")]),s._v(" "),a("p",[s._v("下面是些个人使用经验，供参考。")]),s._v(" "),a("h3",{attrs:{id:"编辑器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编辑器"}},[s._v("#")]),s._v(" 编辑器")]),s._v(" "),a("p",[s._v("我使用的是 VSCode 编辑器，配合 "),a("code",[s._v("Beancount")]),s._v(" 插件（by Lencerf），能够实现语法着色、账户自动补全、数字按小数点对齐、错误提示等，大大提高记账效率。")]),s._v(" "),a("h3",{attrs:{id:"拆分账本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#拆分账本"}},[s._v("#")]),s._v(" 拆分账本")]),s._v(" "),a("p",[s._v("如果按前面的方法记账，一段时间后会发现："),a("strong",[s._v("随着交易增加，账本文件越来越大，维护不方便")]),s._v("。")]),s._v(" "),a("p",[s._v("Beancount 允许将账本拆分，然后通过 "),a("code",[s._v("include")]),s._v(" 语法将账本进行关联起来。比如，我的账本结目录构如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("beancount\n├── 2018\n│   ├── 2018.bean\n│   └── yuegangzhoudian.bean\n├── 2019\n│   ├── 2019.bean\n│   ├── 0-default\n│   │   ├── 00.bean\n│   │   ├── 07-expenses.bean\n│   │   ├── 08-expenses.bean\n│   │   ├── 09-expenses.bean\n│   │   ├── 10-expenses.bean\n│   │   ├── event.bean\n│   │   ├── income.bean\n│   │   └── transfer.bean\n│   ├── 1-securities\n│   │   ├── 00.bean\n│   ├── 2-trip\n│   │   ├── 00.bean\n│   │   ├── 20190708-beijing.bean\n│   │   ├── 20190720-yiwu.bean\n│   ├── 3-cycle\n│   │   ├── 00.bean\n│   │   ├── bankcard.bean\n│   │   ├── creditcard.bean\n│   │   ├── cycle-expenses.bean\n│   │   └── loans.bean\n│   ├── 4-project\n│   │   ├── 00.bean\n│   └── 5-doc\n│       ├── 2019-note.md\n│       ├── creditcard-bill\n│       └── note.xlsx\n├── accounts\n│   ├── assets.bean\n│   ├── equity.bean\n│   ├── expenses.bean\n│   ├── income.bean\n│   └── liabilities.bean\n|── main.bean\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("p",[s._v("最底下的 "),a("code",[s._v("main.bean")]),s._v(" 是我的主账本（查账执行 "),a("code",[s._v("fava main.bean")]),s._v("）。该文件的内容如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(';==main文件==\n;【一、账本设置】\noption "title" "我的账本"\noption "operating_currency" "CNY" \n1990-01-01 custom "fava-option" "language" "zh" \n\n;【二、账户设置】\ninclude "accounts/assets.bean"  ;资产账户设置及初始化\ninclude "accounts/liabilities.bean"  ;负债账户设置及初始化\ninclude "accounts/expenses.bean"  ;支出账户设置\ninclude "accounts/income.bean"  ;收入账户设置\ninclude "accounts/equity.bean"  ;权益账户设置\n\n;【三、交易记录】\ninclude "2018/2018.bean" ;历史账本合集\ninclude "2019/2019.bean" ;2019年账本合集\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("我使用 "),a("code",[s._v("include")]),s._v(" 导入了 7 个文件，其中 5 个账户设置文件，2 个年度账本。")]),s._v(" "),a("p",[s._v("我 2019 年年度账本如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(';==2019.bean文件==\n;2019年每个账本文件的描述\ninclude "0-default/00.bean" ;默认目录，每月日常支出，收入，转账等\ninclude "1-securities/00.bean" ;证券投资目录\ninclude "2-trip/00.bean" ;旅行&出差目录\ninclude "3-cycle/00.bean" ;周期性费用/交易目录\ninclude "4-project/00.bean" ;项目目录\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("code",[s._v("2019.bean")]),s._v(" 文件仍然没有交易记录，而是继续导入其它账本。")]),s._v(" "),a("p",[s._v("概括起来，我的账本结构分三层：")]),s._v(" "),a("p",[s._v("最 1 层："),a("code",[s._v("main.bean")]),s._v(" 作为主账本，include 各个账户文件及每年账本文件。\n第 2 层：每年有个目录，下设"),a("code",[s._v("年份.bean")]),s._v(" 的文件，include 各个子目录下 "),a("code",[s._v("00.bean")]),s._v(" 文件。\n第 3 层：每个子目录下 "),a("code",[s._v("00.bean")]),s._v(" 文件 include 该目录下所有正式的记账文件。")]),s._v(" "),a("p",[s._v("年份目录下各子目录功能如下：")]),s._v(" "),a("ul",[a("li",[s._v("默认目录（0-default）：日常支出，每月一个文件，也包括当年的收入、转账、event 事件。")]),s._v(" "),a("li",[s._v("证券投资（1-securities）：股票和基金买卖记录。")]),s._v(" "),a("li",[s._v("旅行出差（2-trip）：旅行出差的账本，命名"),a("code",[s._v("日期-地点.bean")])]),s._v(" "),a("li",[s._v("周期性账（3-cycle）：包括每月信用卡还款、水电费、车贷房贷等。")]),s._v(" "),a("li",[s._v("项目目录（4-project）：比如装修房子")])]),s._v(" "),a("p",[s._v("这样设计优点：")]),s._v(" "),a("ul",[a("li",[s._v("按年组织，往年数据直接存档，不会被破坏")]),s._v(" "),a("li",[s._v("年份目录下进行分类记录，避免放在一个文件不好维护")])]),s._v(" "),a("h3",{attrs:{id:"定期断言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定期断言"}},[s._v("#")]),s._v(" 定期断言")]),s._v(" "),a("p",[s._v("前面介绍复式记账优点时提到：")]),s._v(" "),a("blockquote",[a("p",[s._v("这种方式能够保证记账准确无误。")])]),s._v(" "),a("p",[s._v("在 Beancount 中通过 "),a("code",[s._v("balance")]),s._v(" 实现账户核对。")]),s._v(" "),a("p",[s._v("假设在 10 月 17 日 24 点，尾号 1234 的银行卡余额为 5000 元，记录如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("2019-10-18 balance Assets:Card:1234   5000.00 CNY\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Beancount 会自动汇总 10 月 17 日（含）以前尾号 1234 的银行卡所有收支，如果历史交易记录无误，那么计算出来也应该是 5000 元。若不是 5000 元，则 Beancount 报错，表示历史交易记录有误。")]),s._v(" "),a("p",[s._v("细心的朋友会发现，10 月 17 日 24 点余额，balance 时使用 2019-10-18。")]),s._v(" "),a("p",[s._v("我一般"),a("strong",[s._v("每月对所有账户进行一次断言")]),s._v("，频繁使用的账户月中会视情况穿插几次断言，避免错误。")]),s._v(" "),a("h3",{attrs:{id:"错误-误差处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#错误-误差处理"}},[s._v("#")]),s._v(" 错误 / 误差处理")]),s._v(" "),a("p",[s._v("如果断言报错，一般我会回溯，因为每月有断言的习惯，所以最多回溯一月数据即可。若无法回溯，则使用 "),a("code",[s._v("Euqity:UFO")]),s._v(" 记录。")]),s._v(" "),a("p",[s._v("假如断言时发现 "),a("code",[s._v("Assets:Card:1234")]),s._v(" 少了 200 元，则在断言前增加：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('2019-10-18 * "" ""\n    Assets:Card:1234    -200.00 CNY\n    Equity:UFO\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("另一个错误场景是误差。假如存在四舍五入的误差，我用 "),a("code",[s._v("Equity:Round")]),s._v(" 处理，比如：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('2019-10-09 * "支付宝基金" "购买基金110011易方达中小盘混合"\n    Assets:Bank:CMB:XXXX           -450.00 CNY\n    Assets:Alipay:Fund               85.05 FD_110011 {5.2830 CNY}\n    Expenses:Commission:AlipayFund    0.67 CNY\n    Equity:Round\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("code",[s._v("Equity")]),s._v(" 账户是个很特别的存在，可以处理边缘情况。我设置了四个 "),a("code",[s._v("Equity")]),s._v(" 账户如下：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("Equity:OpenBalance")]),s._v(" 用于初始化")]),s._v(" "),a("li",[a("code",[s._v("Equity:HistoryIncome")]),s._v(" 开始复式记账（2019-07-01）前的部分收入")]),s._v(" "),a("li",[a("code",[s._v("Equity:Round")]),s._v(" 四舍五入操作")]),s._v(" "),a("li",[a("code",[s._v("Equity:UFO")]),s._v(" 无法追溯的差额")])]),s._v(" "),a("h3",{attrs:{id:"多币种及货币转化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多币种及货币转化"}},[s._v("#")]),s._v(" 多币种及货币转化")]),s._v(" "),a("p",[s._v("账户可以根据实际情况设置多个货币。比如 Visa 信用卡美元消费以美元入账，则需要支持美元。")]),s._v(" "),a("p",[s._v("对于美元消费以人民币入账，可以使用 "),a("code",[s._v("@@")]),s._v("进行货币转化。比如，本博客的服务器账单如下，3.71 美元以 26.57 入账。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('2019-10-04 * "Amazon" "付lightsail服务器月账单"\n    Liabilities:CreditCard:SPDB:XXXX          -26.57 CNY\n    Expenses:Digital:Software                   3.71 USD @@ 26.57 CNY\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("在 "),a("code",[s._v("option")]),s._v(" 中设置"),a("strong",[s._v("账本")]),s._v("货币时，通常只需要一种主货币，Fava 显示时，非主货币都会放进「其它」那一列，如图 1。")]),s._v(" "),a("h3",{attrs:{id:"标签"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#标签"}},[s._v("#")]),s._v(" 标签")]),s._v(" "),a("p",[s._v("一个问题：约会时的用餐，该记在哪个账户？")]),s._v(" "),a("p",[s._v("可以记在 "),a("code",[s._v("Expenses:Food")]),s._v(" 饮食支出账户，也可以记在 "),a("code",[s._v("Expenses:Date:Food")]),s._v(" 约会分类下饮食。如果使用后者，Food 类账户越来越多，不便于维护。")]),s._v(" "),a("p",[s._v("此时，我一般使用前者，并借助 Beancount 提供的标签功能。如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('2019-10-18 * "" "" #Date\n    Assets:Card:1234        -200.00 CNY\n    Expenses:Food\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("其中"),a("code",[s._v("#Date")]),s._v(" 是标签，在 Fava 上可以筛选标签，查看该标签下各个账户的收支。")]),s._v(" "),a("p",[s._v("再比如，每次旅游，我会给旅游中所有的花费打上类似"),a("code",[s._v("#20191001-hangzhou")]),s._v(" 的标签，带有日期和目的地。通过筛选标签，轻易的查看旅游中的吃、住、行、玩等等花销。")]),s._v(" "),a("p",[s._v("旅行的交易通常很多，一条条添加标签比较繁琐，Beancount 支持使用 "),a("code",[s._v("pushtag")]),s._v(" 和 "),a("code",[s._v("poptag")]),s._v(" 给多笔交易加上标签。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('pushtag #20191001-hangzhou\n\n2019-10-18 * "" "" \n    Assets:Card:1234        -200.00 CNY\n    Expenses:Food:Dinner\n    \n2019-10-18 * "" "" \n    Assets:Card:1234         -20.00 CNY\n    Expenses:Traffic:Taxi\n\npoptag #20191001-hangzhou\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("这样，在 "),a("code",[s._v("pushtag")]),s._v(" 和 "),a("code",[s._v("poptag")]),s._v(" 之间的所有交易，都会带上"),a("code",[s._v("#20191001-hangzhou")]),s._v(" 标签.")]),s._v(" "),a("h3",{attrs:{id:"事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事件"}},[s._v("#")]),s._v(" 事件")]),s._v(" "),a("p",[s._v("生活中可能有些事件希望被记录，这已经和记账没多大关系了，不过 Beancount 也支持，格式：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('日期 event "事件分类" "事件详情"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("比如我的事件举例：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(';beancount事件\n2019-06-30 event "beancount" "启用beancount"\n\n;工作事件\n2019-08-30 event "work" "神马lastday"\n2019-09-02 event "work" "今天开始在AE上班"\n\n;旅行或出差记录location事件\n2019-09-13 event "location" "杭州->苏州：去程"\n2019-09-15 event "location" "苏州->杭州：回程"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("然后 Fava 界面有事件查看界面。")]),s._v(" "),a("h2",{attrs:{id:"四、结语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、结语"}},[s._v("#")]),s._v(" 四、结语")]),s._v(" "),a("p",[s._v("没想到写了这么多，断断续续也写了多天，有点意犹未尽。")]),s._v(" "),a("p",[s._v("学习过程中，除了 byvoid 的"),a("a",{attrs:{href:"https://www.byvoid.com/zht/blog/beancount-bookkeeping-1",target:"_blank",rel:"noopener noreferrer"}},[s._v("文章"),a("OutboundLink")],1),s._v("，还参考了 wzyboy 和 "),a("a",{attrs:{href:"https://wzyboy.im/post/1063.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Beancount —— 命令行复式簿记"),a("OutboundLink")],1),s._v("和"),a("a",{attrs:{href:"https://docs.google.com/document/d/1RaondTJCS_IUPBHFNdT8oqFKJjVJDsfsn6JEjBG04eA/edit",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("能用这种方式去记账，很大程度上利益于移动支付的普及。熟练之后，每天晚上对照支付宝和微信账单，3 分钟就能记完。")]),s._v(" "),a("p",[s._v("当然，这仍然不是最好的方式，wzyboy 已经实现了 import，每月花一两个小时处理一次即可。我觉得 import 的方式得到的信息不够丰富和详细，所以没有深入研究。")]),s._v(" "),a("p",[s._v("Beancount 还有些高级应用，比如记录证券投资，使用 BQL 语句统计分析。各种满足工具控的折腾欲。")])])}),[],!1,null,null,null);n.default=t.exports}}]);